(()=>{let r=document.querySelectorAll(".planograma");if(r.length){let e=!0,S=1;for(r.forEach(e=>{e.style.setProperty("--fridge-width",e.firstElementChild.offsetWidth+"px"),e.firstElementChild.classList.add("fridge-"+fridgeShelfLayout.width),e.firstElementChild.style.setProperty("--fridge-width",fridgeShelfLayout.width+"px")}),window.addEventListener("resize",()=>{r.forEach(e=>{e.style.setProperty("--fridge-width",e.firstElementChild.offsetWidth+"px")})});e&&void 0!==fridgeShelfLayout["shelf_"+S];)r.forEach(e=>{var e=e.querySelector(".body-inner"),t=document.createElement("section"),r=(t.classList.add("inner-shelf","shelf-"+fridgeShelfLayout.shelf_size),t.dataset.shelfIndex=S,fridgeShelfLayout["shelf_"+S].clip_strip&&t.classList.add("clip-strip"),document.createElement("ul"));r.classList.add("shelf-body","shelf-body-"+fridgeShelfLayout.shelf_size),r.setAttribute("role","group"),r.setAttribute("aria-label",`Shelf body number 1, ${fridgeShelfLayout["shelf_"+S].sku.length} items`),r.style.setProperty("--shelf-body-columns",fridgeShelfLayout["shelf_"+S].sku.length);let a=1,l=1;var s={};for(let e=1;e<=fridgeShelfLayout["shelf_"+S].sku.length;e++){var o=fridgeShelfLayout["shelf_"+S].sku[e-1],n=fridgeShelfLayout["shelf_"+S].sku[e-2],n=(1<e&&(o!==n?(s[a]=l,a++,l=1):l++,e===fridgeShelfLayout["shelf_"+S].sku.length)&&(s[a]=l),document.createElement("li")),i=document.createElement("button");i.setAttribute("aria-label",ariaLablesForSku[o]||""),i.setAttribute("tabindex","-1");var d=document.querySelector(".zonebottom").querySelector(`.product[data-sku="${o}"]`),u=d.querySelector(".live-inventory-v2-shipping"),c=document.createElement("img");c.classList.add("f-p-"+(fridgeShelfLayout["shelf_"+S].image_padding||"0")),d&&u&&u.classList.contains("out-stock")&&c.classList.add("out-of-stock"),c.src=`https://eu.evocdn.io/dealer/1872/content/media/My_Theme/assets/img-item_sku/${o}.png`,c.setAttribute("draggable",!1),c.setAttribute("alt",ariaLablesForSku[o]||""),c.dataset.sku=o,c.dataset.index=a,i.append(c),n.append(i),r.append(n)}var f=2*fridgeShelfLayout["shelf_"+S].sku.length,h=document.createElement("div");h.classList.add("shelf-footer","shelf-footer-"+fridgeShelfLayout.shelf_size),h.setAttribute("role","group"),h.setAttribute("aria-label",`Shelf footer number 1, ${a} imputs`),h.style.setProperty("--shelf-footer-columns",f);let y=f;for(let e=1;e<=a;e++){var m=document.createElement("input"),p=(m.classList.add("shelf-input"),m.dataset.index=e,m.setAttribute("value","0"),m.setAttribute("type","text"),m.setAttribute("maxlength","3"),2*s[e]),p=f-(y-=p)-s[e]||1;m.style.setProperty("--footer-grid-column",p+"/"+(p+2)),h.append(m)}var v=document.createElement("div"),g=(v.classList.add("add-shelf-wrapper"),document.createElement("button")),k=(g.classList.add("add-shelf"),g.textContent="Add Shelf To Cart",document.createElement("button"));k.classList.add("clear","clear-shelf"),k.textContent="Clear shelf",v.append(g,k),t.append(r,h,v),e.append(t)}),S++,void 0===fridgeShelfLayout["shelf_"+S]&&(e=!1);let v=0,g=[];Array.isArray(g)||(g=[]);var a=document.querySelectorAll(".shelf-body");let t=document.querySelectorAll(".shelf-footer .shelf-input");var l=document.querySelectorAll(".add-shelf"),s=document.querySelector(".add-basket");let k=document.querySelector(".zonebottom");var o=document.querySelector(".clear-all"),n=document.querySelectorAll(".clear-shelf");function i(){document.onkeydown=null,window.onkeydown=null}function d(e){try{v=0;var t=e.dataset.index,a=e.closest(".inner-shelf"),l=a.querySelectorAll(`img[data-index="${t}"]`),s=l[0].dataset.sku;let r=k.querySelector(`.product[data-sku="${s}"]`);if(t&&a&&l.length&&s&&r){let t=(e,t="")=>{e=r.querySelector(e);return e?e.textContent.trim().replace(/\s+/g," "):t};v=(e=>{e=t(e,"0");return parseFloat(e.replace(/[^0-9.]/g,""))||0})(".live-inventory-v2-shipping");var o=r.dataset.itemName||"",n=t(".price-label"),i=t(".price-label-inc-vat"),d=t(".uom.uomblock"),u=t(".live-inventory-v2-shipping");c=o,f=n,h=i,y=d,m=u,(p=document.querySelector(".fridge-header-display")).querySelector(".product-name").textContent=c,p.querySelector(".product-total-price .ex-vat").textContent=f,p.querySelector(".product-total-price .inc-vat").textContent=h,p.querySelector(".product-total-price .pack-uom").textContent=y,p.querySelector(".product-total-price .in-stock").textContent=m,Array.isArray(g)&&g.length&&g.forEach(e=>{e.classList.remove("chosen")}),(g=Array.from(l)).forEach(e=>{e.classList.add("chosen")})}}catch(e){console.error("Error in selectElement:",e)}var c,f,h,y,m,p}function u(e=t){e.forEach(e=>{e.value="0"})}async function c(a){return new Promise(e=>{var t=k.querySelector(`.product[data-sku="${a.sku}"]`);let r=t.querySelector(".btn-add-to-cart");t.querySelector(".inputquantity").value=a.value,setTimeout(()=>{r.click(),e("success")},50)})}u(),o.addEventListener("click",()=>{u()}),n.forEach(e=>{e.addEventListener("click",()=>{u(e.closest(".inner-shelf").querySelectorAll("input"))})}),l.forEach(e=>{e.addEventListener("click",async e=>{function t(e){"Escape"!==e.key&&27!==e.keyCode||(e.stopPropagation(),e.preventDefault())}e.preventDefault(),swal({title:"Processing...",text:"Please wait...",showConfirmButton:!1,closeOnClickOutside:!1,closeOnEsc:!0,html:!0}),document.addEventListener("keydown",t,!0);var r,a,e=e.target.closest(".inner-shelf").querySelectorAll("input");for(r of e)"0"!==r.value&&(a=r.dataset.index,await c({sku:r.closest(".inner-shelf").querySelector(`img[data-index="${a}"]`).dataset.sku,value:r.value}));document.removeEventListener("keydown",t,!0),swal({title:"Success",text:"All elements were added to the basket",type:"success",timer:1e3,showConfirmButton:!1}),u(e),setTimeout(()=>{i()},1100)})}),s.addEventListener("click",async e=>{function t(e){"Escape"!==e.key&&27!==e.keyCode||(e.stopPropagation(),e.preventDefault())}e.preventDefault(),swal({title:"Processing...",text:"Please wait...",showConfirmButton:!1,closeOnClickOutside:!1,closeOnEsc:!1,html:!0}),document.addEventListener("keydown",t,!0);var r,a,l,e=document.querySelectorAll(".shelf-footer input"),s={};let o={};document.addEventListener("cart-add-success",e=>{o[e.detail.sku]=e.detail.qty,console.log(e.detail)});for(r of e)"0"!==r.value&&(a=r.dataset.index,a=r.closest(".inner-shelf").querySelector(`img[data-index="${a}"]`).dataset.sku,l=r.value,s[a]=parseInt(l),await c({sku:a,value:l}));console.log("wait a second");await new Promise((e,t)=>{setTimeout(e,1e3)});console.log(s),console.log(o),document.removeEventListener("keydown",t,!0),swal({title:"Success",text:"All elements were added to the basket",type:"success",timer:1e3,showConfirmButton:!1}),u(),setTimeout(()=>{i()},1100)}),t.forEach(e=>{e.addEventListener("input",e=>{e.target.value=e.target.value.replace(/[^0-9]/g,"")})}),t.forEach(t=>{t.addEventListener("keydown",e=>{"Enter"===e.key&&(e.preventDefault(),t.blur())})}),t.forEach(e=>{e.addEventListener("blur",e=>{var t=parseInt(e.target.value),r=v?parseInt(v):0,t=!isNaN(t)&&0<=t?Math.min(t,r):0;e.target.value=String(t)})}),t.forEach(r=>{r.addEventListener("focus",e=>{var t;"0"===r.value?r.value="":(t=r.value,r.value="",r.value=t),d(e.target)})}),a.forEach(e=>{e.addEventListener("click",e=>{"IMG"!==e.target.tagName||g.length&&e.target.dataset.sku===g[0].dataset.sku||d(e.target)}),e.addEventListener("keydown",e=>{"Enter"!==e.key&&" "!==e.key||"BUTTON"!==document.activeElement.tagName||(e.preventDefault(),g.length&&e.target.querySelector("img").dataset.sku===g[0].dataset.sku)||d(e.target.querySelector("img"))})})}})();